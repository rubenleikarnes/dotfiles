(()=>{"use strict";var e={5933:(e,t,r)=>{var o,s,n=Object.create,i=Object.defineProperty,a=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,l=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,d=(e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of c(t))u.call(e,s)||s===r||i(e,s,{get:()=>t[s],enumerable:!(o=a(t,s))||o.enumerable});return e},f=(o={"node_modules/request-light/lib/node/main.js"(e){(()=>{var t={46:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,{signal:r}={}){return new Promise(((o,s)=>{function n(){null==r||r.removeEventListener("abort",n),e.removeListener(t,i),e.removeListener("error",a)}function i(...e){n(),o(e)}function a(e){n(),s(e)}null==r||r.addEventListener("abort",n),e.on(t,i),e.on("error",a)}))}},54:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const s=r(361),n=o(r(374)),i=o(r(304)),a=n.default("agent-base");function c(){const{stack:e}=new Error;return"string"==typeof e&&e.split("\n").some((e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:")))}function l(e,t){return new l.Agent(e,t)}!function(e){class t extends s.EventEmitter{constructor(e,t){super();let r=t;"function"==typeof e?this.callback=e:e&&(r=e),this.timeout=null,r&&"number"==typeof r.timeout&&(this.timeout=r.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return"number"==typeof this.explicitDefaultPort?this.explicitDefaultPort:c()?443:80}set defaultPort(e){this.explicitDefaultPort=e}get protocol(){return"string"==typeof this.explicitProtocol?this.explicitProtocol:c()?"https:":"http:"}set protocol(e){this.explicitProtocol=e}callback(e,t,r){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(e,t){const r=Object.assign({},t);"boolean"!=typeof r.secureEndpoint&&(r.secureEndpoint=c()),null==r.host&&(r.host="localhost"),null==r.port&&(r.port=r.secureEndpoint?443:80),null==r.protocol&&(r.protocol=r.secureEndpoint?"https:":"http:"),r.host&&r.path&&delete r.path,delete r.agent,delete r.hostname,delete r._defaultAgent,delete r.defaultPort,delete r.createConnection,e._last=!0,e.shouldKeepAlive=!1;let o=!1,s=null;const n=r.timeout||this.timeout,l=t=>{e._hadError||(e.emit("error",t),e._hadError=!0)},u=()=>{s=null,o=!0;const e=new Error(`A "socket" was not created for HTTP request before ${n}ms`);e.code="ETIMEOUT",l(e)},d=e=>{o||(null!==s&&(clearTimeout(s),s=null),l(e))},f=t=>{if(o)return;if(null!=s&&(clearTimeout(s),s=null),n=t,Boolean(n)&&"function"==typeof n.addRequest)return a("Callback returned another Agent instance %o",t.constructor.name),void t.addRequest(e,r);var n;if(t)return t.once("free",(()=>{this.freeSocket(t,r)})),void e.onSocket(t);const i=new Error(`no Duplex stream was returned to agent-base for \`${e.method} ${e.path}\``);l(i)};if("function"==typeof this.callback){this.promisifiedCallback||(this.callback.length>=3?(a("Converting legacy callback function to promise"),this.promisifiedCallback=i.default(this.callback)):this.promisifiedCallback=this.callback),"number"==typeof n&&n>0&&(s=setTimeout(u,n)),"port"in r&&"number"!=typeof r.port&&(r.port=Number(r.port));try{a("Resolving socket for %o request: %o",r.protocol,`${e.method} ${e.path}`),Promise.resolve(this.promisifiedCallback(e,r)).then(f,d)}catch(e){Promise.reject(e).catch(d)}}else l(new Error("`callback` is not defined"))}freeSocket(e,t){a("Freeing socket %o %o",e.constructor.name,t),e.destroy()}destroy(){a("Destroying agent %o",this.constructor.name)}}e.Agent=t,e.prototype=e.Agent.prototype}(l||(l={})),e.exports=l},304:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(t,r){return new Promise(((o,s)=>{e.call(this,t,r,((e,t)=>{e?s(e):o(t)}))}))}}},370:function(e,t,r){var o=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(s,n){function i(e){try{c(o.next(e))}catch(e){n(e)}}function a(e){try{c(o.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(808)),i=s(r(404)),a=s(r(310)),c=s(r(374)),l=s(r(46)),u=r(54),d=(0,c.default)("http-proxy-agent");class f extends u.Agent{constructor(e){let t;if(t="string"==typeof e?a.default.parse(e):e,!t)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");d("Creating new HttpProxyAgent instance: %o",t),super(t);const r=Object.assign({},t);var o;this.secureProxy=t.secureProxy||"string"==typeof(o=r.protocol)&&/^https:?$/i.test(o),r.host=r.hostname||r.host,"string"==typeof r.port&&(r.port=parseInt(r.port,10)),!r.port&&r.host&&(r.port=this.secureProxy?443:80),r.host&&r.path&&(delete r.path,delete r.pathname),this.proxy=r}callback(e,t){return o(this,void 0,void 0,(function*(){const{proxy:r,secureProxy:o}=this,s=a.default.parse(e.path);let c;if(s.protocol||(s.protocol="http:"),s.hostname||(s.hostname=t.hostname||t.host||null),null==s.port&&(t.port,1)&&(s.port=String(t.port)),"80"===s.port&&(s.port=""),e.path=a.default.format(s),r.auth&&e.setHeader("Proxy-Authorization",`Basic ${Buffer.from(r.auth).toString("base64")}`),o?(d("Creating `tls.Socket`: %o",r),c=i.default.connect(r)):(d("Creating `net.Socket`: %o",r),c=n.default.connect(r)),e._header){let t,r;d("Regenerating stored HTTP header string for request"),e._header=null,e._implicitHeader(),e.output&&e.output.length>0?(d("Patching connection write() output buffer with updated header"),t=e.output[0],r=t.indexOf("\r\n\r\n")+4,e.output[0]=e._header+t.substring(r),d("Output buffer: %o",e.output)):e.outputData&&e.outputData.length>0&&(d("Patching connection write() output buffer with updated header"),t=e.outputData[0].data,r=t.indexOf("\r\n\r\n")+4,e.outputData[0].data=e._header+t.substring(r),d("Output buffer: %o",e.outputData[0].data))}return yield(0,l.default)(c,"connect"),c}))}}t.default=f},201:function(e,t,r){const o=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(r(370));function s(e){return new o.default(e)}var n;(n=s||(s={})).HttpProxyAgent=o.default,n.prototype=o.default.prototype,e.exports=s},146:function(e,t,r){var o=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(s,n){function i(e){try{c(o.next(e))}catch(e){n(e)}}function a(e){try{c(o.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(r(808)),i=s(r(404)),a=s(r(310)),c=s(r(491)),l=s(r(374)),u=r(54),d=s(r(829)),f=l.default("https-proxy-agent:agent");class h extends u.Agent{constructor(e){let t;if(t="string"==typeof e?a.default.parse(e):e,!t)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");f("creating new HttpsProxyAgent instance: %o",t),super(t);const r=Object.assign({},t);var o;this.secureProxy=t.secureProxy||"string"==typeof(o=r.protocol)&&/^https:?$/i.test(o),r.host=r.hostname||r.host,"string"==typeof r.port&&(r.port=parseInt(r.port,10)),!r.port&&r.host&&(r.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in r)&&(r.ALPNProtocols=["http 1.1"]),r.host&&r.path&&(delete r.path,delete r.pathname),this.proxy=r}callback(e,t){return o(this,void 0,void 0,(function*(){const{proxy:r,secureProxy:o}=this;let s;o?(f("Creating `tls.Socket`: %o",r),s=i.default.connect(r)):(f("Creating `net.Socket`: %o",r),s=n.default.connect(r));const a=Object.assign({},r.headers);let l=`CONNECT ${t.host}:${t.port} HTTP/1.1\r\n`;r.auth&&(a["Proxy-Authorization"]=`Basic ${Buffer.from(r.auth).toString("base64")}`);let{host:u,port:h,secureEndpoint:g}=t;var m,v;m=h,v=g,Boolean(!v&&80===m||v&&443===m)||(u+=`:${h}`),a.Host=u,a.Connection="close";for(const e of Object.keys(a))l+=`${e}: ${a[e]}\r\n`;const y=d.default(s);s.write(`${l}\r\n`);const{statusCode:w,buffered:S}=yield y;if(200===w){if(e.once("socket",p),t.secureEndpoint){f("Upgrading socket connection to TLS");const e=t.servername||t.host;return i.default.connect(Object.assign(Object.assign({},function(e,...t){const r={};let o;for(o in e)t.includes(o)||(r[o]=e[o]);return r}(t,"host","hostname","path","port")),{socket:s,servername:e}))}return s}s.destroy();const b=new n.default.Socket({writable:!1});return b.readable=!0,e.once("socket",(e=>{f("replaying proxy buffer for failed request"),c.default(e.listenerCount("data")>0),e.push(S),e.push(null)})),b}))}}function p(e){e.resume()}t.default=h},18:function(e,t,r){const o=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(r(146));function s(e){return new o.default(e)}var n;(n=s||(s={})).HttpsProxyAgent=o.default,n.prototype=o.default.prototype,e.exports=s},829:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(r(374)).default("https-proxy-agent:parse-proxy-response");t.default=function(e){return new Promise(((t,r)=>{let o=0;const n=[];function i(){const r=e.read();r?function(e){n.push(e),o+=e.length;const r=Buffer.concat(n,o);if(-1===r.indexOf("\r\n\r\n"))return s("have not received end of HTTP headers yet..."),void i();const a=r.toString("ascii",0,r.indexOf("\r\n")),c=+a.split(" ")[1];s("got proxy server response: %o",a),t({statusCode:c,buffered:r})}(r):e.once("readable",i)}function a(e){s("onclose had error %o",e)}function c(){s("onend")}e.on("error",(function t(o){e.removeListener("end",c),e.removeListener("error",t),e.removeListener("close",a),e.removeListener("readable",i),s("onerror %o",o),r(o)})),e.on("close",a),e.on("end",c),i()}))}},539:function(e,t,r){var o,s=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorStatusDescription=t.xhr=t.configure=void 0;var i=r(685),a=r(687),c=r(310),l=r(472),u=r(796),d=r(201),f=r(18);if(process.env.VSCODE_NLS_CONFIG){var h=process.env.VSCODE_NLS_CONFIG;l.config(JSON.parse(h))}var p=l.loadMessageBundle(),g=void 0,m=!0;function v(e){var t;return new Promise((function(r,o){var s=(0,c.parse)(e.url),n={hostname:s.hostname,agent:!!e.agent&&e.agent,port:s.port?parseInt(s.port):"https:"===s.protocol?443:80,path:s.path,method:e.type||"GET",headers:e.headers,rejectUnauthorized:"boolean"!=typeof e.strictSSL||e.strictSSL};e.user&&e.password&&(n.auth=e.user+":"+e.password);var l=function(o){if(o.statusCode>=300&&o.statusCode<400&&e.followRedirects&&e.followRedirects>0&&o.headers.location){var n=o.headers.location;n.startsWith("/")&&(n=(0,c.format)({protocol:s.protocol,hostname:s.hostname,port:s.port,pathname:n})),r(v(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach((function(t){return Object.keys(t).forEach((function(r){return e[r]=t[r]}))})),e}({},e,{url:n,followRedirects:e.followRedirects-1})))}else r({req:t,res:o})};(t="https:"===s.protocol?a.request(n,l):i.request(n,l)).on("error",o),e.timeout&&t.setTimeout(e.timeout),e.data&&t.write(e.data),t.end(),e.token&&(e.token.isCancellationRequested&&t.destroy(new y),e.token.onCancellationRequested((function(){t.destroy(new y)})))}))}t.configure=function(e,t){g=e,m=t},t.xhr=function(e){return"boolean"!=typeof(e=n({},e)).strictSSL&&(e.strictSSL=m),e.agent||(e.agent=function(e,t){void 0===t&&(t={});var r,o=(0,c.parse)(e),s=t.proxyUrl||("http:"===(r=o).protocol?process.env.HTTP_PROXY||process.env.http_proxy||null:"https:"===r.protocol&&(process.env.HTTPS_PROXY||process.env.https_proxy||process.env.HTTP_PROXY||process.env.http_proxy)||null);if(!s)return null;var n=(0,c.parse)(s);if(!/^https?:$/.test(n.protocol))return null;var i={host:n.hostname,port:Number(n.port),auth:n.auth,rejectUnauthorized:"boolean"!=typeof t.strictSSL||t.strictSSL,protocol:n.protocol};return"http:"===o.protocol?d(i):f(i)}(e.url,{proxyUrl:g,strictSSL:m})),"number"!=typeof e.followRedirects&&(e.followRedirects=5),v(e).then((function(r){return new Promise((function(o,s){var n,i,a=r.res,l=a,d=!1,f=a.headers&&a.headers["content-encoding"];if(f&&(n=e.type,i=r.res.statusCode,!("HEAD"===n||i>=100&&i<200||204===i||304===i))){var h={flush:u.constants.Z_SYNC_FLUSH,finishFlush:u.constants.Z_SYNC_FLUSH};if("gzip"===f){var g=u.createGunzip(h);a.pipe(g),l=g}else if("deflate"===f){var m=u.createInflate(h);a.pipe(m),l=m}}var v=[];l.on("data",(function(e){return v.push(e)})),l.on("end",(function(){if(!d){if(d=!0,e.followRedirects>0&&(a.statusCode>=300&&a.statusCode<=303||307===a.statusCode)){var r=a.headers.location;if(r.startsWith("/")){var n=(0,c.parse)(e.url);r=(0,c.format)({protocol:n.protocol,hostname:n.hostname,port:n.port,pathname:r})}if(r){var i={type:e.type,url:r,user:e.user,password:e.password,headers:e.headers,timeout:e.timeout,followRedirects:e.followRedirects-1,data:e.data,token:e.token};return void(0,t.xhr)(i).then(o,s)}}var l=Buffer.concat(v),u={responseText:l.toString(),body:l,status:a.statusCode,headers:a.headers||{}};a.statusCode>=200&&a.statusCode<300||1223===a.statusCode?o(u):s(u)}})),l.on("error",(function(t){var r;r=y.is(t)?t:{responseText:p("error","Unable to access {0}. Error: {1}",e.url,t.message),body:Buffer.concat(v),status:500,headers:{}},d=!0,s(r)})),e.token&&(e.token.isCancellationRequested&&l.destroy(new y),e.token.onCancellationRequested((function(){l.destroy(new y)})))}))}),(function(t){var r;return r=y.is(t)?t:{responseText:e.agent?p("error.cannot.connect.proxy","Unable to connect to {0} through a proxy. Error: {1}",e.url,t.message):p("error.cannot.connect","Unable to connect to {0}. Error: {1}",e.url,t.message),body:Buffer.concat([]),status:404,headers:{}},Promise.reject(r)}))},t.getErrorStatusDescription=function(e){if(!(e<400))switch(e){case 400:return p("status.400","Bad request. The request cannot be fulfilled due to bad syntax.");case 401:return p("status.401","Unauthorized. The server is refusing to respond.");case 403:return p("status.403","Forbidden. The server is refusing to respond.");case 404:return p("status.404","Not Found. The requested location could not be found.");case 405:return p("status.405","Method not allowed. A request was made using a request method not supported by that location.");case 406:return p("status.406","Not Acceptable. The server can only generate a response that is not accepted by the client.");case 407:return p("status.407","Proxy Authentication Required. The client must first authenticate itself with the proxy.");case 408:return p("status.408","Request Timeout. The server timed out waiting for the request.");case 409:return p("status.409","Conflict. The request could not be completed because of a conflict in the request.");case 410:return p("status.410","Gone. The requested page is no longer available.");case 411:return p("status.411",'Length Required. The "Content-Length" is not defined.');case 412:return p("status.412","Precondition Failed. The precondition given in the request evaluated to false by the server.");case 413:return p("status.413","Request Entity Too Large. The server will not accept the request, because the request entity is too large.");case 414:return p("status.414","Request-URI Too Long. The server will not accept the request, because the URL is too long.");case 415:return p("status.415","Unsupported Media Type. The server will not accept the request, because the media type is not supported.");case 500:return p("status.500","Internal Server Error.");case 501:return p("status.501","Not Implemented. The server either does not recognize the request method, or it lacks the ability to fulfill the request.");case 503:return p("status.503","Service Unavailable. The server is currently unavailable (overloaded or down).");default:return p("status.416","HTTP status code {0}",e)}};var y=function(e){function t(){var r=e.call(this,"The user aborted a request")||this;return r.name="AbortError",Object.setPrototypeOf(r,t.prototype),r}return s(t,e),t.is=function(e){return e instanceof t},t}(Error)},800:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.loadMessageBundle=t.localize=t.format=t.setPseudo=t.isPseudo=t.isDefined=t.BundleFormat=t.MessageFormat=void 0;var o,s,n,i=r(926);function a(e){return void 0!==e}function c(e,r){return t.isPseudo&&(e="［"+e.replace(/[aouei]/g,"$&$&")+"］"),0===r.length?e:e.replace(/\{(\d+)\}/g,(function(e,t){var o=t[0],s=r[o],n=e;return"string"==typeof s?n=s:"number"!=typeof s&&"boolean"!=typeof s&&null!=s||(n=String(s)),n}))}(n=t.MessageFormat||(t.MessageFormat={})).file="file",n.bundle="bundle",n.both="both",(s=t.BundleFormat||(t.BundleFormat={})).standalone="standalone",s.languagePack="languagePack",(o||(o={})).is=function(e){var t=e;return t&&a(t.key)&&a(t.comment)},t.isDefined=a,t.isPseudo=!1,t.setPseudo=function(e){t.isPseudo=e},t.format=c,t.localize=function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return c(t,r)},t.loadMessageBundle=function(e){return(0,i.default)().loadMessageBundle(e)},t.config=function(e){return(0,i.default)().config(e)}},926:(e,t)=>{var r;function o(){if(void 0===r)throw new Error("No runtime abstraction layer installed");return r}Object.defineProperty(t,"__esModule",{value:!0}),(o||(o={})).install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");r=e},t.default=o},472:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=t.loadMessageBundle=t.BundleFormat=t.MessageFormat=void 0;var o=r(17),s=r(147),n=r(926),i=r(800),a=r(800);Object.defineProperty(t,"MessageFormat",{enumerable:!0,get:function(){return a.MessageFormat}}),Object.defineProperty(t,"BundleFormat",{enumerable:!0,get:function(){return a.BundleFormat}});var c,l,u=Object.prototype.toString;function d(e){return"[object String]"===u.call(e)}function f(e){return JSON.parse(s.readFileSync(e,"utf8"))}function h(e){return function(t,r){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];return function(e){return"[object Number]"===u.call(e)}(t)?t>=e.length?void console.error("Broken localize call found. Index out of bounds. Stacktrace is\n: ".concat(new Error("").stack)):(0,i.format)(e[t],o):d(r)?(console.warn("Message ".concat(r," didn't get externalized correctly.")),(0,i.format)(r,o)):void console.error("Broken localize call found. Stacktrace is\n: ".concat(new Error("").stack))}}function p(e,t){return c[e]=t,t}function g(e){try{return function(e){var t=f(o.join(e,"nls.metadata.json")),r=Object.create(null);for(var s in t){var n=t[s];r[s]=n.messages}return r}(e)}catch(e){return void console.log("Generating default bundle from meta data failed.",e)}}function m(e){if(!e)return i.localize;var t=o.extname(e);if(t&&(e=e.substr(0,e.length-t.length)),l.messageFormat===i.MessageFormat.both||l.messageFormat===i.MessageFormat.bundle){var r=function(e){for(var t,r=o.dirname(e);t=o.join(r,"nls.metadata.header.json"),!s.existsSync(t);){var n=o.dirname(r);if(n===r){t=void 0;break}r=n}return t}(e);if(r){var n=o.dirname(r),a=c[n];if(void 0===a)try{var u=JSON.parse(s.readFileSync(r,"utf8"));try{var m=function(e,t){var r;if(!0===l.languagePackSupport&&void 0!==l.cacheRoot&&void 0!==l.languagePackId&&void 0!==l.translationsConfigFile&&void 0!==l.translationsConfig)try{r=function(e,t){var r,n,i,a=o.join(l.cacheRoot,"".concat(e.id,"-").concat(e.hash,".json")),c=!1,u=!1;try{return r=JSON.parse(s.readFileSync(a,{encoding:"utf8",flag:"r"})),n=a,i=new Date,s.utimes(n,i,i,(function(){})),r}catch(e){if("ENOENT"===e.code)u=!0;else{if(!(e instanceof SyntaxError))throw e;console.log("Syntax error parsing message bundle: ".concat(e.message,".")),s.unlink(a,(function(e){e&&console.error("Deleting corrupted bundle ".concat(a," failed."))})),c=!0}}if(!(r=function(e,t){var r=l.translationsConfig[e.id];if(r){var s=f(r).contents,n=f(o.join(t,"nls.metadata.json")),i=Object.create(null);for(var a in n){var c=n[a],u=s["".concat(e.outDir,"/").concat(a)];if(u){for(var h=[],p=0;p<c.keys.length;p++){var g=c.keys[p],m=u[d(g)?g:g.key];void 0===m&&(m=c.messages[p]),h.push(m)}i[a]=h}else i[a]=c.messages}return i}}(e,t))||c)return r;if(u)try{s.writeFileSync(a,JSON.stringify(r),{encoding:"utf8",flag:"wx"})}catch(e){if("EEXIST"===e.code)return r;throw e}return r}(e,t)}catch(e){console.log("Load or create bundle failed ",e)}if(!r){if(l.languagePackSupport)return g(t);var n=function(e){for(var t=l.language;t;){var r=o.join(e,"nls.bundle.".concat(t,".json"));if(s.existsSync(r))return r;var n=t.lastIndexOf("-");t=n>0?t.substring(0,n):void 0}if(void 0===t&&(r=o.join(e,"nls.bundle.json"),s.existsSync(r)))return r}(t);if(n)try{return f(n)}catch(e){console.log("Loading in the box message bundle failed.",e)}r=g(t)}return r}(u,n);a=p(n,m?{header:u,nlsBundle:m}:null)}catch(e){console.error("Failed to load nls bundle",e),a=p(n,null)}}catch(e){console.error("Failed to read header file",e),a=p(n,null)}if(a){var v=e.substr(n.length+1).replace(/\\/g,"/"),y=a.nlsBundle[v];return void 0===y?(console.error("Messages for file ".concat(e," not found. See console for details.")),function(){return"Messages not found."}):h(y)}}}if(l.messageFormat===i.MessageFormat.both||l.messageFormat===i.MessageFormat.file)try{var w=f(function(e){var t;if(l.cacheLanguageResolution&&t);else{if(i.isPseudo||!l.language)t=".nls.json";else for(var r=l.language;r;){var o=".nls."+r+".json";if(s.existsSync(e+o)){t=o;break}var n=r.lastIndexOf("-");n>0?r=r.substring(0,n):(t=".nls.json",r=null)}l.cacheLanguageResolution}return e+t}(e));return Array.isArray(w)?h(w):(0,i.isDefined)(w.messages)&&(0,i.isDefined)(w.keys)?h(w.messages):(console.error("String bundle '".concat(e,"' uses an unsupported format.")),function(){return"File bundle has unsupported format. See console for details"})}catch(e){"ENOENT"!==e.code&&console.error("Failed to load single file bundle",e)}return console.error("Failed to load message bundle for file ".concat(e)),function(){return"Failed to load message bundle. See console for details."}}function v(e){return e&&(d(e.locale)&&(l.locale=e.locale.toLowerCase(),l.language=l.locale,c=Object.create(null)),void 0!==e.messageFormat&&(l.messageFormat=e.messageFormat),e.bundleFormat===i.BundleFormat.standalone&&!0===l.languagePackSupport&&(l.languagePackSupport=!1)),(0,i.setPseudo)("pseudo"===l.locale),m}!function(){if(l={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:i.MessageFormat.bundle},d(process.env.VSCODE_NLS_CONFIG))try{var e=JSON.parse(process.env.VSCODE_NLS_CONFIG),t=void 0;if(e.availableLanguages){var r=e.availableLanguages["*"];d(r)&&(t=r)}if(d(e.locale)&&(l.locale=e.locale.toLowerCase()),void 0===t?l.language=l.locale:"en"!==t&&(l.language=t),(!0===(a=e._languagePackSupport)||!1===a)&&(l.languagePackSupport=e._languagePackSupport),d(e._cacheRoot)&&(l.cacheRoot=e._cacheRoot),d(e._languagePackId)&&(l.languagePackId=e._languagePackId),d(e._translationsConfigFile)){l.translationsConfigFile=e._translationsConfigFile;try{l.translationsConfig=f(l.translationsConfigFile)}catch(t){if(e._corruptedFile){var n=o.dirname(e._corruptedFile);s.exists(n,(function(t){t&&s.writeFile(e._corruptedFile,"corrupted","utf8",(function(e){console.error(e)}))}))}}}}catch(a){}var a;(0,i.setPseudo)("pseudo"===l.locale),c=Object.create(null)}(),t.loadMessageBundle=m,t.config=v,n.default.install(Object.freeze({loadMessageBundle:m,config:v}))},374:(e,t)=>{function r(){}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r}},491:e=>{e.exports=r(9491)},361:e=>{e.exports=r(2361)},147:e=>{e.exports=r(7147)},685:e=>{e.exports=r(3685)},687:e=>{e.exports=r(5687)},808:e=>{e.exports=r(1808)},17:e=>{e.exports=r(1017)},404:e=>{e.exports=r(4404)},310:e=>{e.exports=r(7310)},796:e=>{e.exports=r(9796)}},o={},s=function e(r){var s=o[r];if(void 0!==s)return s.exports;var n=o[r]={exports:{}};return t[r].call(n.exports,n,n.exports,e),n.exports}(539),n=e;for(var i in s)n[i]=s[i];s.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})()}},function(){return s||(0,o[c(o)[0]])((s={exports:{}}).exports,s),s.exports}),h={};((e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})})(h,{config:()=>y,t:()=>w}),e.exports=(e=>d(i({},"__esModule",{value:!0}),e))(h);var p,g=r(7147),m=r(3292),v=((e,t,r)=>(r=null!=e?n(l(e)):{},d(e&&e.__esModule?r:i(r,"default",{value:e,enumerable:!0}),e)))(f());function y(e){if("contents"in e)p="string"==typeof e.contents?JSON.parse(e.contents):e.contents;else if("fsPath"in e){const r=(t=e.fsPath,(0,g.readFileSync)(t,"utf8")),o=JSON.parse(r);p=_(o)?o.contents.bundle:o}else{var t;if(e.uri){let t=e.uri;return"string"==typeof e.uri&&(t=new URL(e.uri)),new Promise(((e,r)=>{const o=async function(e){if("file:"===e.protocol)return await(0,m.readFile)(e,"utf8");if("http:"===e.protocol||"https:"===e.protocol)try{const t=await(0,v.xhr)({url:e.toString(),followRedirects:5,headers:{"Accept-Encoding":"gzip, deflate",Accept:"application/json"}});return(new TextDecoder).decode(t.body)}catch(e){throw new Error(e.responseText??(0,v.getErrorStatusDescription)(e.status)??e.toString())}throw new Error("Unsupported protocol")}(t).then((e=>{try{const t=JSON.parse(e);p=_(t)?t.contents.bundle:t}catch(e){r(e)}})).catch((e=>{r(e)}));e(o)}))}}}function w(...e){const t=e[0];let r,o,s;if("string"==typeof t)r=t,o=t,e.splice(0,1),s=e&&"object"==typeof e[0]?e[0]:e;else{if(t instanceof Array){const r=e.slice(1);if(t.length!==r.length+1)throw new Error("expected a string as the first argument to l10n.t");let o=t[0];for(let e=1;e<t.length;e++)o+=`{${e-1}}`+t[e];return w(o,...r)}o=t.message,r=o,t.comment&&t.comment.length>0&&(r+=`/${Array.isArray(t.comment)?t.comment.join(""):t.comment}`),s=t.args??{}}const n=p?.[r];return n?"string"==typeof n?b(n,s):n.comment?b(n.message,s):b(o,s):b(o,s)}var S=/{([^}]+)}/g;function b(e,t){return e.replace(S,((e,r)=>t[r]??e))}function _(e){return!("object"!=typeof e?.contents?.bundle||"string"!=typeof e?.version)}},6381:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.nullLogFile=t.createLogFile=void 0;const o=r(7147),s=r(1017),n=r(3837);t.createLogFile=function(e,t){const r=(0,s.join)(e,`${t}-${(new Date).toISOString().replace(/[Z: -\.]/g,"").substr(0,15)}.log`);o.mkdirSync(e,{recursive:!0});const i=o.createWriteStream(r,{flags:"a"});return{location:r,log:(e,...t)=>{const r=`[${(new Date).toISOString().replace(/[TZ]/g," ").trim()}] ${n.format(e,...t)}\n`;i.write(r)},close:()=>new Promise((e=>{i.end(),i.once("finish",(()=>{e()}))}))}},t.nullLogFile=function(){return{location:"",log:()=>{},close:()=>Promise.resolve()}}},2257:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=t.getNodeExecServer=void 0;const o=r(6637),s=r(2081),n=r(2037),i=r(7147);function a(e,t){const r=new u,o=new l;return{id:c++,onData(s,n,i){const a=o.event(s,n,i);return 1===o.size&&(e.on("data",(e=>{null==t||t.write(`toReadStream: on('data')) : ${e.length}`),o.fire(e)})),e.on("end",(()=>{null==t||t.write("toReadStream: end)"),r.complete()}))),a},onEnd:r.p}}t.getNodeExecServer=function(){return{async exec({env:e,cmd:t,args:r,cwd:o,output:i,options:l}){var u;const d=o?` in ${o}}`:"",f=`NodeExecServer run: ${t} ${null!==(u=null==r?void 0:r.join(" ").replace(/\n/g,"\\n"))&&void 0!==u?u:""}${d}`;i.write(f),(null==l?void 0:l.verbose)&&i.write(`NodeExecServer: ${n.platform} - ${n.platform}, env:`);const h={windowsHide:null==l?void 0:l.windowsHide,shell:null==l?void 0:l.shell,env:e,cwd:o,windowsVerbatimArguments:null==l?void 0:l.windowsVerbatimArguments,stdio:"pipe"},p=s.spawn(t,r,h),g=a(p.stdout),m=a(p.stderr);return{stdin:(v=p.stdin,{id:c++,write(e){v.write(e)},end(){v.end()}}),stdout:g,stderr:m,exit:new Promise(((e,t)=>{p.once("error",(e=>{(null==l?void 0:l.verbose)&&i.write(`NodeExecServer: Error ${e.message}`),t(e)})),p.once("exit",((t,r)=>{(null==l?void 0:l.verbose)&&i.write(`NodeExecServer: Exit ${t} ${r}`),Promise.all([g.onEnd,m.onEnd]).then((()=>{e({status:null!=t?t:0,message:null!=r?r:void 0})}))}))})),async terminate(){p.kill("SIGKILL")}};var v},acquireCli(){throw new Error("Not implemented")},spawnCli(){throw new Error("Not implemented")},serve(){throw new Error("Not implemented")},fs:{async stat(e){try{const t=await i.promises.stat(e);let r=t.isFile()?o.FileType.File:t.isDirectory()?o.FileType.Directory:o.FileType.Unknown;return t.isSymbolicLink()&&(r|=o.FileType.SymbolicLink),{type:r}}catch(e){return}}},getEnv:async()=>({env:process.env,osRelease:n.release(),osPlatform:function(){switch(n.platform()){case"win32":return"win32";case"darwin":return"darwin";default:return"linux"}}()})}};let c=2e4;class l{constructor(){this.event=(e,t,r)=>{const o=this.add(t?e.bind(t):e);return Array.isArray(r)&&r.push(o),o}}get size(){return this.listeners?"function"==typeof this.listeners?1:this.listeners.length:0}fire(e){if(this.listeners)if("function"==typeof this.listeners)this.listeners(e);else for(const t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?"function"==typeof this.listeners?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if("function"==typeof this.listeners)return void(this.listeners===e&&(this.listeners=void 0));const t=this.listeners.indexOf(e);-1!==t&&(2===this.listeners.length?this.listeners=0===t?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}}t.EventEmitter=l;class u{get isRejected(){return this.rejected}get isResolved(){return this.resolved}get isSettled(){return this.rejected||this.resolved}constructor(){this.rejected=!1,this.resolved=!1,this.p=new Promise(((e,t)=>{this.completeCallback=e,this.errorCallback=t}))}complete(e){this.completeCallback(e),this.resolved=!0}error(e){this.errorCallback(e),this.rejected=!0}}},5680:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadProgress=t.MakeDefaultRequest=t.DownloadRequest=t.FatalErrorOccuredNotification=t.PortResolvedNotification=t.LogNotification=t.ProgressNotification=void 0;const o=r(8231);t.ProgressNotification=new o.NotificationType("progressNotification"),t.LogNotification=new o.NotificationType("logNotification"),t.PortResolvedNotification=new o.NotificationType("portResolvedNotification"),t.FatalErrorOccuredNotification=new o.NotificationType("fatalErrorOccuredNotification"),t.DownloadRequest=new o.RequestType("downloadRequest"),t.MakeDefaultRequest=new o.RequestType("makeDefault"),t.DownloadProgress=new o.ProgressType},7374:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupRemoteServer=void 0;const o=r(5933),s=r(6113),n=r(7147),i=r(679),a=r(1821),c=r(6637),l=r(2309),u=new TextDecoder;async function d(e,t,r){const o=["kill",r];try{await(0,c.runExec)(await e.executeDistroExe(t,o))}catch(e){}}function f(e){const t={...e},r=Object.keys(t);for(const e of r)e.match(/^(ELECTRON_|VSCODE_)/)&&delete t[e];return t}t.setupRemoteServer=async function(e,t){const r=e.logger,h=await(0,c.getWSLExecServer)((()=>Promise.resolve(t)),void 0,r);return new Promise((async t=>{var g;let m,v,y,w="",S=0,b="",_=[],E="";const x=`${s.randomInt(4294967295)}-${s.randomInt(4294967295)}-${s.randomInt(4294967295)}-${s.randomInt(4294967295)}`,L=(e,r,o,s=!1,n=!0)=>{clearTimeout(v),t({kind:"failure",message:e,wslVersion:E,checkLog:o,handled:s,modal:n,reason:r,platform:null==m?void 0:m.platform})};async function T(s){if(clearTimeout(v),y)try{const o=new a.WSLServerProxy(e.distro,h,r,e.enableDebug),n=await o.start(y,s);e.onExit.push((()=>o.dispose())),t({kind:"success",port:n,wslVersion:E,connectionToken:x,platform:null==m?void 0:m.platform})}catch(e){L(o.t("Exception while setting up the WSL server proxy: {0}",String(e)),l.FailureReason.Undefined,!0)}else L(o.t("Did not receive location of the remote node executable"),l.FailureReason.Undefined,!0)}const C=t=>{const r=t.match(/(\d+)%$/);let o=0;if(r){const e=Math.min(parseInt(r[1],10),100);0===e&&(S=0),e>S&&(o=e-S,S=e)}const s=t;(b!==s||o>0)&&(b=s,e.sendProgress({increment:45*o/100,message:s}))},P=()=>{let t=!1;if(N)N=!1,R=0,$&&(e.sendProgress({increment:0,message:o.t("Installing WSL components")}),$=!1);else if(R++,R>300)return void L(o.t("VS Code Server for WSL failed to start. No messages received for {0}s",Math.floor(90)),l.FailureReason.Timeout,!0);return O.length&&(r.write(O),t=(t=>{for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);if(10===o){const t=w;w="";let r=t.match(/^WSL-shell-PID: ([\d]+)/);if(r){if("2"===e.wslVersion){const t=r[1];e.onExit.push((()=>d(h,e.distro,t)))}continue}if(r=t.match(/^Extension host agent listening on (\d+)/),r)return T(parseInt(r[1],10)),!0;if(r=t.match(/^IP Address: ([\d\.]+)/),r){_.push(r[1]);continue}if(r=t.match(/^WSL version: (.+)/),r){E=r[1];continue}if(r=t.match(/^Node executable: (.+)/),r){y=r[1];continue}C(t)}else 8===o?w.length>0&&(w=w.substr(0,w.length-1)):w+=t.charAt(r)}return C(w),!1})(O),O=""),k.length&&(r.write(k,l.LogLevel.error),k=""),t};let O="",k="",N=!1,R=0,$=!0;if(!h.isExecAndDistroArgumentSupported()&&!(0,i.compareCaseInsensitive)(e.defaultDistro,e.distro)&&!await e.setDefaultDistro(e.distro,e.defaultDistro))return void L(o.t("To open a non-distro, the WSL extension requires a newer version of WSL: ({0}).",c.WIN10_1903.label),l.FailureReason.WSLUpdateRequired,!1,!0);const{commit:M,quality:D,serverDataFolderName:W}=e.productConfiguration;if(M&&!D)return void L(o.t("VSCode Client ({0}) does not define a quality.",e.appRoot),l.FailureReason.Undefined,!0);const q=W||".vscode-remote";let F,j;if(M){try{m=await async function(e,t,o){const s="install-found ",n=`if [ -d ~/${t}/bin/${o} ]; then printf '${s}'; fi; if [ -f /etc/alpine-release ]; then printf alpine-; fi; uname -m`;r.write(`Probing if server is already installed: ${n}`);try{const t=await(0,c.runExec)(await h.executeDistroShellCommand(e,n));if(t.status)throw new Error(`Failed to probe if server is already installed: code: ${t.status}, ${t.stderr}, ${t.stdout}`);{const e=t.stdout.trim();r.write(`Probing result: ${e}`);const o=e.startsWith(s),n=o?e.substring(14):e,i=function(e){switch(e){case"x86_64":return"linux-x64";case"aarch64":return"linux-arm64";case"alpine-x86_64":return"linux-alpine";case"alpine-aarch64":return"alpine-arm64";default:return}}(n);return i||r.write(`${n} is an unsupported platform. Please file a feature request.`,l.LogLevel.error),{installFound:o,platform:i}}}catch(e){throw new Error(`Failed to probe if server is already installed: code: ${e.message}`)}}(e.distro,q,M),m.installFound?r.write("Server install found in WSL"):r.write(`No server install found in WSL, needs ${null!==(g=m.platform)&&void 0!==g?g:"unknown"}`)}catch(e){if(r.write(`Unable to detect if server is already installed: ${e}`,l.LogLevel.error),"string"==typeof e.message&&-1!==e.message.indexOf("https://aka.ms/wsl2kernel")){const e=o.t({comment:["Do not change link syntax [message](command). Do only translate message.",'{Locked="](https://aka.ms/wsl2kernel)"}'],message:"WSL 2 requires an update to its kernel component. For instructions visit [here](https://aka.ms/wsl2kernel)."});L(e,l.FailureReason.WSLUpdateRequired,!1,!1,!1)}h.windowsBuildNumber<=c.WIN10_1803.build&&r.write(`When using Alpine on ${c.WIN10_1803.label}, make sure that 'bash' is installed. ('apk update && apk add bash')${e}`,l.LogLevel.error)}if(m&&!m.installFound&&m.platform){r.write("Getting server from client side");let t=0;try{F=await e.sendDownloadRequest(M,m.platform,(r=>{const s=Math.ceil(45*r.received/r.total);s>t&&(e.sendProgress({increment:s-t,message:o.t("Downloading server...")}),t=s),R=0})),r.write(`Server available at ${F}`)}catch(e){r.write(`Unable to download server on client side: ${e}. Will try to download on WSL side.`,l.LogLevel.error)}}else e.sendProgress({increment:90,message:o.t("Connecting to server...")})}M&&e.useScriptlessStartup?(F&&(e.sendProgress({increment:0,message:o.t("Unpacking server...")}),await async function(t,o,s){const i={useDefaultShell:!0,options:{windowsVerbatimArguments:!0}},a=`$HOME/${t}/bin`;{r.write(`Remove old installs from ${a}`);const t=await h.executeDistroShellCommand(e.distro,`'if [ -d "${a}" ]; then rm -rf "${a}"/????????????????????????????????????????; rm -rf "${a}"/????????????????????????????????????????-*; fi'`,i),o=await(0,c.runExecWithLogger)(t,r);o&&r.write(`Failed to remove old installs ${a}: error code ${o}`)}const l=`${a}/${o}-${(new Date).getTime()}`;{r.write(`Create directory ${l}`);const t=await h.executeDistroShellCommand(e.distro,`'mkdir -p "${l}"'`,i),o=await(0,c.runExecWithLogger)(t,r);if(o)throw new Error(`Failed to create directory ${l}: error code ${o}`)}{r.write(`Extract server from ${s} to ${l}`);const t=await h.executeDistroShellCommand(e.distro,`'tar -xz -C "${l}" --strip-components 1'`,i),o=await(0,c.runExecWithLogger)(t,r,void 0,n.createReadStream(s));if(o)throw new Error(`Failed to extract server from ${s} to ${l}: error code ${o}`)}{const t=`${a}/${o}`;r.write(`Move directory ${l} to ${t}`);const s=await h.executeDistroShellCommand(e.distro,`'mv "${l}" "${t}"'`,i),n=await(0,c.runExecWithLogger)(s,r);if(n)throw new Error(`Failed to move directory ${l}: error code ${n}`)}}(q,M,F)),j=await async function(t,o,s){const n=`$HOME/${t}/server-env-setup`,i=`$HOME/${t}/bin/${o}/bin/${e.productConfiguration.serverApplicationName}`,a=p(s);r.write(`Starting server at ${i}...`);const c=[`if [ -f "${n}" ]; then echo "sourcing ${t}/server-env-setup"; . "${n}"; fi`,`printf "WSL-shell-PID: $$\nWSL version: $(uname -r)\nNode executable: $HOME/${t}/bin/${o}/node\n"`,`"${i}" ${a.join(" ")}`];return await h.executeDistroShellCommand(e.distro,`'${c.join(";\n")}'`,{useDefaultShell:!0,options:{windowsVerbatimArguments:!0}})}(q,M,x)):j=M?await async function(t,o,s,n){const i=h.isWSLEnvAvailable(),a=p(s);let c=`"${i?"$VSCODE_WSL_EXT_LOCATION":"."}/scripts/wslServer.sh" ${o} ${e.productConfiguration.quality||"insider"} ${e.productConfiguration.serverApplicationName} ${t} ${a.join(" ")}`;e.enableDebug&&(c="env && VSCODE_WSL_DEBUG_INFO=true "+c),c=`'${c}'`;const l=f(h.env);if(i){const t=[];l.VSCODE_WSL_EXT_LOCATION=e.wslExtensionLocation,t.push("VSCODE_WSL_EXT_LOCATION/up"),n&&(l.VSCODE_SERVER_TAR=n,t.push("VSCODE_SERVER_TAR/up")),l.WSLENV&&t.push(h.env.WSLENV),l.WSLENV=t.join(":")}let u=i?void 0:e.wslExtensionLocation;const d=await h.executeDistroShellCommand(e.distro,c,{env:l,cwd:u,useDefaultShell:!0,options:{windowsVerbatimArguments:!0}});return e.enableDebug&&r.write(`Running with cwd: ${u}, env: ${JSON.stringify(l,null,"  ")}`),d}(q,M,x,F):await async function(t){let o=`"$VSCODE_WSL_EXT_LOCATION/scripts/wslServer-dev.sh" "$VSCODE_WSL_APP_ROOT" ${p(t).join(" ")}`;e.enableDebug&&(o="env && VSCODE_WSL_DEBUG_INFO=true "+o),o=`'${o}'`;const s=f(h.env),n=[];s.VSCODE_WSL_EXT_LOCATION=e.wslExtensionLocation,n.push("VSCODE_WSL_EXT_LOCATION/up"),s.VSCODE_WSL_APP_ROOT=e.appRoot,n.push("VSCODE_WSL_APP_ROOT/up"),s.WSLENV&&n.push(h.env.WSLENV),s.WSLENV=n.join(":");const i=await h.executeDistroShellCommand(e.distro,o,{env:s,useDefaultShell:!0,options:{windowsVerbatimArguments:!0}});return e.enableDebug&&r.write(`Running with env: ${JSON.stringify(s,null,"  ")}`),i}(x),v=setInterval(P,300),j.stdout.onData((e=>{O+=u.decode(e),N=!0})),j.stderr.onData((e=>{k+=u.decode(e),N=!0})),j.exit.then((e=>{P()||L("VS Code Server for WSL closed unexpectedly.",l.FailureReason.ServerCloseError,!0)}),(e=>{P()||L(`VS Code Server for WSL failed with error:\r\n${e.message}`,l.FailureReason.ServerScriptError,!0)}))}));function p(t){const r=[];return r.push("--host=127.0.0.1"),r.push("--port=0"),r.push(`--connection-token=${t}`),r.push("--use-host-proxy"),r.push("--without-browser-env-var"),r.push("--disable-websocket-compression"),r.push("--accept-server-license-terms"),"1"===e.wslVersion&&0!==e.fileWatcherPolling&&r.push(`--file-watcher-polling=${e.fileWatcherPolling}`),e.enableDebug&&r.push("--log=trace"),e.enableTelemetry||r.push("--disable-telemetry"),r.push(`--telemetry-level=${e.telemetryLevel}`),r}}},2309:(e,t)=>{var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.FailureReason=t.LogLevel=void 0,function(e){e[e.info=1]="info",e[e.error=2]="error",e[e.debug=3]="debug"}(r||(t.LogLevel=r={})),function(e){e.ServerScriptError="servererror",e.ServerCloseError="serverclose",e.Timeout="timeout",e.WSLNotFound="wslnotfound",e.WSLUpdateRequired="wslupdaterequired",e.DaemonError="daemonerror",e.DaemonClosed="daemonclosed",e.Undefined="undefined"}(o||(t.FailureReason=o={}))},64:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getProductConfiguration=void 0;const o=r(7147),s=r(1017);let n;t.getProductConfiguration=function(e){if(!n){const t=o.readFileSync(s.join(e,"product.json")).toString();n=JSON.parse(t)}return n}},679:(e,t)=>{function r(e,t){return e.length===t.length&&(e===t||e.toLowerCase()===t.toLowerCase())}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldActivateForAuthority=t.onceSuccessfully=t.getRemoteName=t.AuthorityHierarchy=t.getDistroFromAuthority=t.isAuthorityWsl=t.getAuthorityFromDistro=t.isWSL1=t.isDockerDesktopDistro=t.isEqualAuthority=t.compareCaseInsensitive=void 0,t.compareCaseInsensitive=r,t.isEqualAuthority=function(e,t){return void 0===e?void 0===t:void 0!==t&&r(e,t)},t.isDockerDesktopDistro=function(e){return/^docker-desktop(-data)?$/.test(e)},t.isWSL1=function(e){return-1!==e.indexOf("Microsoft")},t.getAuthorityFromDistro=function(e="default",t){return t?`wsl+${e}@${t}`:"wsl+"+e},t.isAuthorityWsl=function(e){return e.startsWith("wsl+")},t.getDistroFromAuthority=function(e){let t,r;if(e.startsWith("wsl+")&&(t=e.substring(4)),!t)return;const o=t.indexOf("@"),s=t.indexOf("%40"),n=Math.min(-1===o?1/0:o,-1===s?1/0:s);return isFinite(n)&&(r=t.slice(n+1),t=t.slice(0,n)),"default"===t&&(t=void 0),{hostAuthority:r,distro:t}};class o{static parse(e){return new o(e,e.split(/@|%40/g).reverse())}get length(){return this.parts.length}get host(){return this.last.startsWith("wsl+")?1===this.parts.length?void 0:this.parts.slice(0,-1).reverse().join("@"):this.parts.slice().reverse().join("@")}get last(){return this.parts[this.parts.length-1]}constructor(e,t){this.value=e,this.parts=t}has(e){const t=e+"+";return this.parts.some((e=>e.startsWith(t)))}toString(){return this.parts.join(" > ")}}t.AuthorityHierarchy=o,t.getRemoteName=function(e){const t=e.indexOf("+");return-1!==t?e.substring(0,t):e},t.onceSuccessfully=function(e){let t;return()=>(void 0!==t||(t=e(),t.catch((()=>{t=void 0}))),t)};const s=["tunnel+","wsl+"];t.shouldActivateForAuthority=function(e){return s.some((t=>e.startsWith(t)))}},6637:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runExecWithLogger=t.runExec=t.getWSLExecServer=t.WSLExecError=t.WSLExecErrorCode=t.WIN10_1803=t.WIN10_1903=t.WIN10_2004=t.WIN10_21H1=t.FileType=void 0;const o=r(2309),s=r(679);var n,i;!function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Directory=2]="Directory",e[e.SymbolicLink=64]="SymbolicLink"}(n||(t.FileType=n={})),t.WIN10_21H1={label:"Windows 10, May 2021 Update, version 21H1",build:19043},t.WIN10_2004={label:"Windows 10, May 2020 Update, version 2004",build:19041},t.WIN10_1903={label:"Windows 10, May 2019 Update, version 1903",build:18362},t.WIN10_1803={label:"Windows 10, April 2018 Update, version 1803",build:17134},function(e){e[e.WSLCommandNotFound=0]="WSLCommandNotFound",e[e.SystemRootNotFound=1]="SystemRootNotFound",e[e.WSLStatusFailed=2]="WSLStatusFailed",e[e.WSLPathConversionFailed=3]="WSLPathConversionFailed"}(i||(t.WSLExecErrorCode=i={}));class a extends Error{constructor(e,t){super(t),this.wslError=e}}t.WSLExecError=a;const c=new Map;async function l(e,t,r,o){return new Promise(((s,n)=>{const i=[],a=[];e.stdout.onData((e=>{i.push(e),null==o||o.write(`runExec stdout (len: ${e.length}): ${JSON.stringify(e)}`)})),e.stderr.onData((e=>{a.push(e),null==o||o.write(`runExec stderr (len: ${e.length}): ${Buffer.from(e).toString("hex")}`)})),e.exit.then((({status:e})=>{try{const r=Buffer.concat(i).toString(t),n=Buffer.concat(a).toString(t);null==o||o.write(`runExec exit (stdout: chucks: ${i.length}, len: ${r.length}, stderr: chucks: ${a.length}, len: ${n.length})`),0===r.length&&i.length&&(null==o||o.write(JSON.stringify(Buffer.concat(i)))),s({stdout:r,stderr:n,status:e||0})}catch(e){null==o||o.write(`runExec exit (error: ${e})`),n(e)}}),n),r&&(r.on("data",(t=>{e.stdin.write(t)})),r.on("end",(()=>{e.stdin.end()})))}))}t.getWSLExecServer=async function(e,r,o){const u=c.get(r)||await e().then((e=>e.getEnv()));c.set(r,u);const{env:d,osPlatform:f,osRelease:h}=u,p="win32"===f&&h&&/(\d+)\.(\d+)\.(\d+)/g.exec(h),g=p&&4===p.length?parseInt(p[3]):0;function m(...e){const t=d.SystemRoot;if(t)return function(...e){let t=e[0];for(let r=1;r<e.length;r++){const o=e[r];t.endsWith("\\")&&o.startsWith("\\")||(t+="\\"),t+=o}return t}(t,d.PROCESSOR_ARCHITEW6432?"Sysnative":"System32",...e)}function v(){return m("wslconfig.exe")}function y(){return g>=16299}function w(){return m(y()?"wsl.exe":"bash.exe")}async function S(t,r){const s=w();if(!s)throw new a(i.WSLCommandNotFound);const n={windowsVerbatimArguments:!0,verbose:r},c={...process.env,WSL_UTF8:"0"};return l(await e().then((e=>e.exec({cmd:s,args:t,output:o,env:c,options:n}))),"utf16le",void 0,r?o:void 0)}const b=(0,s.onceSuccessfully)((async()=>{if("win32"!==f)return o.write("WSL feature installed: false (not win32)"),!1;if(!(g>=22e3)){const t=m("lxss","LxssManager.dll");if(t)try{const r=await e().then((e=>e.fs.stat(t))),s=!!r&&0!=(r.type|n.File);return o.write(`WSL feature installed: ${s} (dll path)`),!0}catch(e){}return o.write("WSL feature installed: false (no dll path)"),!1}try{const e=!(await S(["--status"])).status;return o.write(`WSL feature installed: ${e} (wsl --status)`),e}catch(e){throw o.write(`WSL feature installed: false (wsl --status failed, ${e.message})`),new a(i.WSLStatusFailed,e.message)}}));function _(e,t,r){const o=[];return x()?(o.push("-d",e),!0!==r&&o.push("-e"),o.push("sh","-c",t)):y()?o.push("sh","-c",t):o.push("-c",t),o}function E(t,r,{env:s,cwd:n,options:c,useDefaultShell:l}={}){const u=w();if(!u)throw new a(i.WSLCommandNotFound);const d=_(t,r,l);return e().then((e=>e.exec({cmd:u,args:d,output:o,env:s,cwd:n,options:c})))}function x(){return g>=17666}return{windowsBuildNumber:g,hostAuthority:r,getWSLConfigExecutablePath:v,getWSLExecutablePath:w,runWSLCommandLine:S,runWSLConfigCommandLine:async function(t,r){const s=v();if(!s)throw new a(i.WSLCommandNotFound);const n={windowsVerbatimArguments:!0,verbose:r},c={...process.env,WSL_UTF8:"0"};return l(await e().then((e=>e.exec({cmd:s,args:t,output:o,env:c,options:n}))),"utf16le",void 0,r?o:void 0)},isWSLInstalled:b,executeDistroShellCommand:E,getDistroShellCommandArgs:_,executeDistroExe:function(t,r,{env:s,cwd:n,options:c,useDefaultShell:l}={}){const u=w();if(!u)throw new a(i.WSLCommandNotFound);const d=[];return x()?(d.push("-d",t),!0!==l&&d.push("-e"),d.push(...r)):d.push(...r),e().then((e=>e.exec({cmd:u,args:d,output:o,env:s,cwd:n,options:c})))},executeWslPath:async function(e,t,r){let o;if(r){let r='echo "$VSCODE_WSL_PATH"';const s={env:{WSLENV:"VSCODE_WSL_PATH/up",VSCODE_WSL_PATH:t}};o=await E(e,r,s)}else{let r='wslpath -w "$VSCODE_WSL_PATH"';const s={env:{WSLENV:"VSCODE_WSL_PATH/u",VSCODE_WSL_PATH:t}};o=await E(e,r,s)}const s=await l(o);if(!s.status)return s.stdout.trim();throw new a(i.WSLPathConversionFailed,s.stderr)},getExecServer:e,isDistroEnvVarAvailable:()=>g>=t.WIN10_1903.build,isWSLPathAvailable:()=>g>=17046,isWSL2Available:()=>g>=18917||g>=t.WIN10_1903.build&&"maybe",isWSLEnvAvailable:()=>g>=17063,isExecAndDistroArgumentSupported:x,isWSLInExplorerAvailable:()=>g>=18342,env:d,osPlatform:f}},t.runExec=l,t.runExecWithLogger=async function(e,t,r,s){const n=new TextDecoder(r);return new Promise(((r,i)=>{e.stdout.onData((e=>{t.write(n.decode(e))})),e.stderr.onData((e=>{t.write(n.decode(e),o.LogLevel.error)})),e.exit.then((({status:e})=>{try{r(e||0)}catch(e){i(e)}}),i),s&&(s.on("data",(t=>{e.stdin.write(t)})),s.on("end",(()=>{e.stdin.end()})))}))}},1821:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WSLServerProxy=void 0;const o=r(1808),s=r(2309);t.WSLServerProxy=class{constructor(e,t,r,o){this.distro=e,this.execServer=t,this.logger=r,this.isDebug=o,this.forwardedPorts=new Set,this.execId=0}start(e,t){return new Promise(((r,n)=>{const i=new Set,a=o.createServer({pauseOnConnect:!0},(async r=>{try{const o=a.address().port,n=this.execId++,c=[e,"-e",`const net = require('net');\n\t\t\t\t\t\tprocess.stdin.pause();\n\t\t\t\t\t\tconst client = net.createConnection({ host: '127.0.0.1', port: ${t} }, () => {\n\t\t\t\t\t\t\tclient.pipe(process.stdout);\n\t\t\t\t\t\t\tprocess.stdin.pipe(client);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tclient.on('close', function (hadError) {\n\t\t\t\t\t\t\tconsole.error(hadError ? 'Remote close with error' : 'Remote close');\n\t\t\t\t\t\t\tprocess.exit(hadError ? 1 : 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tclient.on('error', function (err) {\n\t\t\t\t\t\t\tprocess.stderr.write(err && (err.stack || err.message) || String(err));\n\t\t\t\t\t\t});`.replace(/\s+/g," ")];this.isDebug&&this.logger.write(`Using executable (${n}) to forward requests from local ${o} to remote ${t}`,s.LogLevel.debug);const l=await this.execServer.executeDistroExe(this.distro,c);let u=!1;l.exit.then((({status:e,message:t})=>{u||(i.delete(r),r.end()),this.isDebug&&this.logger.write(`Exec (${n}) has terminated ${u?"(local socket closed)":""} with status ${e} and message ${t}.`,s.LogLevel.debug)})).catch((e=>{this.logger.write(`Exec (${n}) has errored: ${e}`)})),this.isDebug&&l.stderr.onData((e=>{this.logger.write(`Exec (${n}) stderr: ${Buffer.from(e).toString()}`,s.LogLevel.debug)})),r.on("close",(e=>{this.isDebug&&this.logger.write(`Exec (${n}): Local close${e?" with error":""}`,s.LogLevel.debug),u=!0,i.delete(r),l.terminate().catch(console.error)})),r.on("data",(e=>{l.stdin.write(e)})),r.on("end",(()=>{l.stdin.end()})),l.stdout.onData((e=>{r.write(e)})),l.stdout.onEnd.then((()=>{r.end()})),r.resume(),i.add(r)}catch(e){this.logger.write("Exception caught when running forwarding executable"+e,s.LogLevel.error),console.error(e)}}));a.on("listening",(()=>{const e=a.address().port,o={targetPort:t,server:a,localPort:e,connections:i};a.on("close",(()=>{this.forwardedPorts.delete(o)})),this.forwardedPorts.add(o),this.logger.write(`Started local proxy server on ${e}.`),r(e)})),a.on("error",(e=>{!e||"EADDRINUSE"!==e.code&&"EACCES"!==e.code?n(e):a.listen(0,"127.0.0.1")})),a.on("close",(()=>{n(new Error("Closed"))})),a.listen(0,"127.0.0.1")}))}stopForwarding(e){return new Promise(((t,r)=>{e.server.close((e=>{e?r(e):t()}));for(const t of e.connections)t.destroy()}))}async dispose(){for(const e of this.forwardedPorts.values())try{await this.stopForwarding(e)}catch(e){this.logger.write("Exception thrown when closing the server proxy: "+e,s.LogLevel.error)}}}},3126:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(3680),s=r(2593);var n;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:o.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:o.Event.None}),e.is=function(t){let r=t;return r&&(r===e.None||r===e.Cancelled||s.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}}(n=t.CancellationToken||(t.CancellationToken={}));const i=Object.freeze((function(e,t){let r=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(r)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?i:(this._emitter||(this._emitter=new o.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=n.Cancelled}dispose(){this._token?this._token instanceof a&&this._token.dispose():this._token=n.None}}},3680:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),(t.Disposable||(t.Disposable={})).create=function(e){return{dispose:e}},function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class r{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var r=!1,o=0,s=this._callbacks.length;o<s;o++)if(this._callbacks[o]===e){if(this._contexts[o]===t)return this._callbacks.splice(o,1),void this._contexts.splice(o,1);r=!0}if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],r=this._callbacks.slice(0),o=this._contexts.slice(0),s=0,n=r.length;s<n;s++)try{t.push(r[s].apply(o[s],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class o{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,s)=>{let n;return this._callbacks||(this._callbacks=new r),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),n={dispose:()=>{this._callbacks.remove(e,t),n.dispose=o._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(s)&&s.push(n),n}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=o,o._noop=function(){}},2593:(e,t)=>{function r(e){return"string"==typeof e||e instanceof String}function o(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=r,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=o,t.stringArray=function(e){return o(e)&&e.every((e=>r(e)))}},397:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(r=t.Touch||(t.Touch={})),t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,o=r.None){let s=this._map.get(e);if(s)s.value=t,o!==r.None&&this.touch(s,o);else{switch(s={key:e,value:t,next:void 0,previous:void 0},o){case r.None:this.addItemLast(s);break;case r.First:this.addItemFirst(s);break;case r.Last:default:this.addItemLast(s)}this._map.set(e,s),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._head;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.next}forEachReverse(e,t){let r=this._tail;for(;r;)t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),r=r.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===r.First||t===r.Last)if(t===r.First){if(e===this._head)return;const t=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(t.previous=r,r.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===r.Last){if(e===this._tail)return;const t=e.next,r=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=r,r.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},8231:(e,t,r)=>{function o(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const s=r(2593),n=r(3234);t.RequestType=n.RequestType,t.RequestType0=n.RequestType0,t.RequestType1=n.RequestType1,t.RequestType2=n.RequestType2,t.RequestType3=n.RequestType3,t.RequestType4=n.RequestType4,t.RequestType5=n.RequestType5,t.RequestType6=n.RequestType6,t.RequestType7=n.RequestType7,t.RequestType8=n.RequestType8,t.RequestType9=n.RequestType9,t.ResponseError=n.ResponseError,t.ErrorCodes=n.ErrorCodes,t.NotificationType=n.NotificationType,t.NotificationType0=n.NotificationType0,t.NotificationType1=n.NotificationType1,t.NotificationType2=n.NotificationType2,t.NotificationType3=n.NotificationType3,t.NotificationType4=n.NotificationType4,t.NotificationType5=n.NotificationType5,t.NotificationType6=n.NotificationType6,t.NotificationType7=n.NotificationType7,t.NotificationType8=n.NotificationType8,t.NotificationType9=n.NotificationType9;const i=r(6386);t.MessageReader=i.MessageReader,t.StreamMessageReader=i.StreamMessageReader,t.IPCMessageReader=i.IPCMessageReader,t.SocketMessageReader=i.SocketMessageReader;const a=r(9725);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=r(3680);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=r(3126);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const u=r(397);var d,f,h,p,g,m,v,y;o(r(3377)),o(r(2674)),function(e){e.type=new n.NotificationType("$/cancelRequest")}(d||(d={})),function(e){e.type=new n.NotificationType("$/progress")}(f||(f={})),t.ProgressType=class{constructor(){}},t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(h=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!s.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(h=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new n.NotificationType("$/setTraceNotification")}(g=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new n.NotificationType("$/logTraceNotification")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(v=t.ConnectionErrors||(t.ConnectionErrors={}));class w extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,w.prototype)}}function S(e,t,r,o){let i=0,a=0,S=0;const b="2.0";let _,E,x,L,T=Object.create(null),C=Object.create(null),P=new Map,O=new u.LinkedMap,k=Object.create(null),N=Object.create(null),R=h.Off,$=p.Text,M=y.New,D=new c.Emitter,W=new c.Emitter,q=new c.Emitter,F=new c.Emitter,j=new c.Emitter;function A(e){return"req-"+e.toString()}function I(e){}function V(){return M===y.Listening}function U(){return M===y.Closed}function B(){return M===y.Disposed}function H(){M!==y.New&&M!==y.Listening||(M=y.Closed,W.fire(void 0))}function z(){x||0===O.size||(x=setImmediate((()=>{x=void 0,function(){if(0===O.size)return;let e=O.shift();try{n.isRequestMessage(e)?function(e){if(B())return;function r(r,o,s){let i={jsonrpc:b,id:e.id};r instanceof n.ResponseError?i.error=r.toJson():i.result=void 0===r?null:r,G(i,o,s),t.write(i)}function o(r,o,s){let n={jsonrpc:b,id:e.id,error:r.toJson()};G(n,o,s),t.write(n)}!function(e){if(R!==h.Off&&L)if($===p.Text){let t;R===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),L.log(`Received request '${e.method} - (${e.id})'.`,t)}else X("receive-request",e)}(e);let i,a,c=T[e.method];c&&(i=c.type,a=c.handler);let u=Date.now();if(a||_){let c=new l.CancellationTokenSource,d=String(e.id);N[d]=c;try{let l;l=void 0===e.params||void 0!==i&&0===i.numberOfParams?a?a(c.token):_(e.method,c.token):s.array(e.params)&&(void 0===i||i.numberOfParams>1)?a?a(...e.params,c.token):_(e.method,...e.params,c.token):a?a(e.params,c.token):_(e.method,e.params,c.token);let f=l;l?f.then?f.then((t=>{delete N[d],r(t,e.method,u)}),(t=>{delete N[d],t instanceof n.ResponseError?o(t,e.method,u):t&&s.string(t.message)?o(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):o(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)})):(delete N[d],r(l,e.method,u)):(delete N[d],function(r,o,s){void 0===r&&(r=null);let n={jsonrpc:b,id:e.id,result:r};G(n,o,s),t.write(n)}(l,e.method,u))}catch(t){delete N[d],t instanceof n.ResponseError?r(t,e.method,u):t&&s.string(t.message)?o(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):o(new n.ResponseError(n.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else o(new n.ResponseError(n.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):n.isNotificationMessage(e)?function(e){if(B())return;let t,o;if(e.method===d.type.method)o=e=>{let t=e.id,r=N[String(t)];r&&r.cancel()};else{let r=C[e.method];r&&(o=r.handler,t=r.type)}if(o||E)try{!function(e){if(R!==h.Off&&L&&e.method!==m.type.method)if($===p.Text){let t;R===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),L.log(`Received notification '${e.method}'.`,t)}else X("receive-notification",e)}(e),void 0===e.params||void 0!==t&&0===t.numberOfParams?o?o():E(e.method):s.array(e.params)&&(void 0===t||t.numberOfParams>1)?o?o(...e.params):E(e.method,...e.params):o?o(e.params):E(e.method,e.params)}catch(t){t.message?r.error(`Notification handler '${e.method}' failed with message: ${t.message}`):r.error(`Notification handler '${e.method}' failed unexpectedly.`)}else q.fire(e)}(e):n.isResponseMessage(e)?function(e){if(!B())if(null===e.id)e.error?r.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):r.error("Received response message without id. No further error information provided.");else{let t=String(e.id),o=k[t];if(function(e,t){if(R!==h.Off&&L)if($===p.Text){let r;if(R===h.Verbose&&(e.error&&e.error.data?r=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?r=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),t){let o=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";L.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${o}`,r)}else L.log(`Received response ${e.id} without active response promise.`,r)}else X("receive-response",e)}(e,o),o){delete k[t];try{if(e.error){let t=e.error;o.reject(new n.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");o.resolve(e.result)}}catch(e){e.message?r.error(`Response handler '${o.method}' failed with message: ${e.message}`):r.error(`Response handler '${o.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void r.error("Received empty message.");r.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(s.string(t.id)||s.number(t.id)){let e=String(t.id),r=k[e];r&&r.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{z()}}()})))}e.onClose(H),e.onError((function(e){D.fire([e,void 0,void 0])})),t.onClose(H),t.onError((function(e){D.fire(e)}));let J=e=>{try{if(n.isNotificationMessage(e)&&e.method===d.type.method){let r=A(e.params.id),s=O.get(r);if(n.isRequestMessage(s)){let n=o&&o.cancelUndispatched?o.cancelUndispatched(s,I):void 0;if(n&&(void 0!==n.error||void 0!==n.result))return O.delete(r),n.id=s.id,G(n,e.method,Date.now()),void t.write(n)}}!function(e,t){var r;n.isRequestMessage(t)?e.set(A(t.id),t):n.isResponseMessage(t)?e.set(null===(r=t.id)?"res-unknown-"+(++S).toString():"res-"+r.toString(),t):e.set("not-"+(++a).toString(),t)}(O,e)}finally{z()}};function G(e,t,r){if(R!==h.Off&&L)if($===p.Text){let o;R===h.Verbose&&(e.error&&e.error.data?o=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?o=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(o="No result returned.\n\n")),L.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-r}ms`,o)}else X("send-response",e)}function X(e,t){if(!L||R===h.Off)return;const r={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};L.log(r)}function Y(){if(U())throw new w(v.Closed,"Connection is closed.");if(B())throw new w(v.Disposed,"Connection is disposed.")}function Z(e){return void 0===e?null:e}function K(e,t){let r,o=e.numberOfParams;switch(o){case 0:r=null;break;case 1:r=Z(t[0]);break;default:r=[];for(let e=0;e<t.length&&e<o;e++)r.push(Z(t[e]));if(t.length<o)for(let e=t.length;e<o;e++)r.push(null)}return r}let Q={sendNotification:(e,...r)=>{let o,n;if(Y(),s.string(e))switch(o=e,r.length){case 0:n=null;break;case 1:n=r[0];break;default:n=r}else o=e.method,n=K(e,r);let i={jsonrpc:b,method:o,params:n};!function(e){if(R!==h.Off&&L)if($===p.Text){let t;R===h.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),L.log(`Sending notification '${e.method}'.`,t)}else X("send-notification",e)}(i),t.write(i)},onNotification:(e,t)=>{Y(),s.func(e)?E=e:t&&(s.string(e)?C[e]={type:void 0,handler:t}:C[e.method]={type:e,handler:t})},onProgress:(e,t,r)=>{if(P.has(t))throw new Error(`Progress handler for token ${t} already registered`);return P.set(t,r),{dispose:()=>{P.delete(t)}}},sendProgress:(e,t,r)=>{Q.sendNotification(f.type,{token:t,value:r})},onUnhandledProgress:F.event,sendRequest:(e,...r)=>{let o,a,c;if(Y(),function(){if(!V())throw new Error("Call listen() first.")}(),s.string(e))switch(o=e,r.length){case 0:a=null;break;case 1:l.CancellationToken.is(r[0])?(a=null,c=r[0]):a=Z(r[0]);break;default:const e=r.length-1;l.CancellationToken.is(r[e])?(c=r[e],a=2===r.length?Z(r[0]):r.slice(0,e).map((e=>Z(e)))):a=r.map((e=>Z(e)))}else{o=e.method,a=K(e,r);let t=e.numberOfParams;c=l.CancellationToken.is(r[t])?r[t]:void 0}let u=i++,f=new Promise(((e,r)=>{let s={jsonrpc:b,id:u,method:o,params:a},i={method:o,timerStart:Date.now(),resolve:e,reject:r};!function(e){if(R!==h.Off&&L)if($===p.Text){let t;R===h.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),L.log(`Sending request '${e.method} - (${e.id})'.`,t)}else X("send-request",e)}(s);try{t.write(s)}catch(e){i.reject(new n.ResponseError(n.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),i=null}i&&(k[String(u)]=i)}));return c&&c.onCancellationRequested((()=>{Q.sendNotification(d.type,{id:u})})),f},onRequest:(e,t)=>{Y(),s.func(e)?_=e:t&&(s.string(e)?T[e]={type:void 0,handler:t}:T[e.method]={type:e,handler:t})},trace:(e,t,r)=>{let o=!1,n=p.Text;void 0!==r&&(s.boolean(r)?o=r:(o=r.sendNotification||!1,n=r.traceFormat||p.Text)),R=e,$=n,L=R===h.Off?void 0:t,!o||U()||B()||Q.sendNotification(g.type,{value:h.toString(e)})},onError:D.event,onClose:W.event,onUnhandledNotification:q.event,onDispose:j.event,dispose:()=>{if(B())return;M=y.Disposed,j.fire(void 0);let r=new Error("Connection got disposed.");Object.keys(k).forEach((e=>{k[e].reject(r)})),k=Object.create(null),N=Object.create(null),O=new u.LinkedMap,s.func(t.dispose)&&t.dispose(),s.func(e.dispose)&&e.dispose()},listen:()=>{Y(),function(){if(V())throw new w(v.AlreadyListening,"Connection is already listening")}(),M=y.Listening,e.listen(J)},inspect:()=>{console.log("inspect")}};return Q.onNotification(m.type,(e=>{R!==h.Off&&L&&L.log(e.message,R===h.Verbose?e.verbose:void 0)})),Q.onNotification(f.type,(e=>{const t=P.get(e.token);t?t(e.value):F.fire(e)})),Q}t.ConnectionError=w,(t.ConnectionStrategy||(t.ConnectionStrategy={})).is=function(e){let t=e;return t&&s.func(t.cancelUndispatched)},function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,r,o,s){o||(o=t.NullLogger);let n=void 0!==(c=e).listen&&void 0===c.read?e:new i.StreamMessageReader(e);var c;let l=function(e){return void 0!==e.write&&void 0===e.end}(r)?r:new a.StreamMessageWriter(r);return S(n,l,o,s)}},6386:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(3680),s=r(2593);let n=8192,i=Buffer.from("\r","ascii")[0],a=Buffer.from("\n","ascii")[0];class c{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(n)}append(e){var t=e;if("string"==typeof e){var r=e,o=Buffer.byteLength(r,this.encoding);(t=Buffer.allocUnsafe(o)).write(r,0,o,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var s=(Math.ceil((this.index+t.length)/n)+1)*n;0===this.index?(this.buffer=Buffer.allocUnsafe(s),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],s)}this.index+=t.length}tryReadHeaders(){let e,t=0;for(;t+3<this.index&&(this.buffer[t]!==i||this.buffer[t+1]!==a||this.buffer[t+2]!==i||this.buffer[t+3]!==a);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach((t=>{let r=t.indexOf(":");if(-1===r)throw new Error("Message header must separate key and value using :");let o=t.substr(0,r),s=t.substr(r+1).trim();e[o]=s}));let r=t+4;return this.buffer=this.buffer.slice(r),this.index=this.index-r,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),r=e;return this.buffer.copy(this.buffer,0,r),this.index=this.index-r,t}get numberOfBytes(){return this.index}}(t.MessageReader||(t.MessageReader={})).is=function(e){let t=e;return t&&s.func(t.listen)&&s.func(t.dispose)&&s.func(t.onError)&&s.func(t.onClose)&&s.func(t.onPartialMessage)};class l{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter,this.partialMessageEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=l;class u extends l{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new c(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",(e=>{this.onData(e)})),this.readable.on("error",(e=>this.fireError(e))),this.readable.on("close",(()=>this.fireClose()))}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let r=parseInt(t);if(isNaN(r))throw new Error("Content-Length value must be a number.");this.nextMessageLength=r}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var r=JSON.parse(t);this.callback(r)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=u,t.IPCMessageReader=class extends l{constructor(e){super(),this.process=e;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose()))}listen(e){this.process.on("message",e)}},t.SocketMessageReader=class extends u{constructor(e,t="utf-8"){super(e,t)}}},9725:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(3680),s=r(2593);let n="Content-Length: ",i="\r\n";(t.MessageWriter||(t.MessageWriter={})).is=function(e){let t=e;return t&&s.func(t.dispose)&&s.func(t.onClose)&&s.func(t.onError)&&s.func(t.write)};class a{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${s.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=a,t.StreamMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",(e=>this.fireError(e))),this.writable.on("close",(()=>this.fireClose()))}write(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),o=[n,r.toString(),i,i];try{this.writable.write(o.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}},t.IPCMessageWriter=class extends a{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",(e=>this.fireError(e))),t.on("close",(()=>this.fireClose))}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,(t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}},t.SocketMessageWriter=class extends a{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",(e=>this.fireError(e))),this.socket.on("close",(()=>this.fireClose()))}dispose(){super.dispose(),this.socket.destroy()}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),r=Buffer.byteLength(t,this.encoding),o=[n,r.toString(),i,i];try{this.sending=!0,this.socket.write(o.join(""),"ascii",(r=>{r&&this.handleError(r,e);try{this.socket.write(t,this.encoding,(t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(r){this.handleError(r,e)}}))}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},3234:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(2593);var s;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.ContentModified=-32801,e.MessageWriteError=1,e.MessageReadError=2}(s=t.ErrorCodes||(t.ErrorCodes={}));class n extends Error{constructor(e,t,r){super(t),this.code=o.number(e)?e:s.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,n.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=n;class i{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=i,t.RequestType0=class extends i{constructor(e){super(e,0)}},t.RequestType=class extends i{constructor(e){super(e,1)}},t.RequestType1=class extends i{constructor(e){super(e,1)}},t.RequestType2=class extends i{constructor(e){super(e,2)}},t.RequestType3=class extends i{constructor(e){super(e,3)}},t.RequestType4=class extends i{constructor(e){super(e,4)}},t.RequestType5=class extends i{constructor(e){super(e,5)}},t.RequestType6=class extends i{constructor(e){super(e,6)}},t.RequestType7=class extends i{constructor(e){super(e,7)}},t.RequestType8=class extends i{constructor(e){super(e,8)}},t.RequestType9=class extends i{constructor(e){super(e,9)}},t.NotificationType=class extends i{constructor(e){super(e,1),this._=void 0}},t.NotificationType0=class extends i{constructor(e){super(e,0)}},t.NotificationType1=class extends i{constructor(e){super(e,1)}},t.NotificationType2=class extends i{constructor(e){super(e,2)}},t.NotificationType3=class extends i{constructor(e){super(e,3)}},t.NotificationType4=class extends i{constructor(e){super(e,4)}},t.NotificationType5=class extends i{constructor(e){super(e,5)}},t.NotificationType6=class extends i{constructor(e){super(e,6)}},t.NotificationType7=class extends i{constructor(e){super(e,7)}},t.NotificationType8=class extends i{constructor(e){super(e,8)}},t.NotificationType9=class extends i{constructor(e){super(e,9)}},t.isRequestMessage=function(e){let t=e;return t&&o.string(t.method)&&(o.string(t.id)||o.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&o.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(o.string(t.id)||o.number(t.id)||null===t.id)}},3377:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(1017),s=r(2037),n=r(6113),i=r(1808),a=r(6386),c=r(9725);t.generateRandomPipeName=function(){const e=n.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:o.join(s.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let r,o=new Promise(((e,t)=>{r=e}));return new Promise(((s,n)=>{let l=i.createServer((e=>{l.close(),r([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])}));l.on("error",n),l.listen(e,(()=>{l.removeListener("error",n),s({onConnected:()=>o})}))}))},t.createServerPipeTransport=function(e,t="utf-8"){const r=i.createConnection(e);return[new a.SocketMessageReader(r,t),new c.SocketMessageWriter(r,t)]}},2674:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(1808),s=r(6386),n=r(9725);t.createClientSocketTransport=function(e,t="utf-8"){let r,i=new Promise(((e,t)=>{r=e}));return new Promise(((a,c)=>{let l=o.createServer((e=>{l.close(),r([new s.SocketMessageReader(e,t),new n.SocketMessageWriter(e,t)])}));l.on("error",c),l.listen(e,"127.0.0.1",(()=>{l.removeListener("error",c),a({onConnected:()=>i})}))}))},t.createServerSocketTransport=function(e,t="utf-8"){const r=o.createConnection(e,"127.0.0.1");return[new s.SocketMessageReader(r,t),new n.SocketMessageWriter(r,t)]}},9491:e=>{e.exports=require("assert")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3292:e=>{e.exports=require("fs/promises")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}var o={};(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0});const t=r(5933),s=r(1808),n=r(8231),i=r(5680),a=r(6381),c=r(7374),l=r(2309),u=r(64),d=r(2257),f=process.env.VSCODE_WSL_PIPE_NAME,h=parseInt(process.env.VSCODE_WSL_EXT_HOST_PID||"0",10),p=process.env.VSCODE_WSL_EXT_LOCATION,g=process.env.VSCODE_WSL_APP_ROOT,m=!!process.env.VSCODE_WSL_ENABLE_TELEMETRY,v=parseInt(process.env.VSCODE_FILE_WATCHER_POLLING||"0"),y=!!process.env.VSCODE_WSL_SCRIPTLESS_STARTUP,w=process.env.VSCODE_WSL_VERSION,S=process.env.VSCODE_WSL_DISTRO,b=!!process.env.VSCODE_WSL_DEBUG_INFO,_=process.env.VSCODE_WSL_DEFAULT_DISTRO,E=process.env.VSCODE_WSL_LOG_FILE_LOCATION,x=process.env.VSCODE_TELEMETRY_LEVEL,L=process.env.VSCODE_L10N_BUNDLE_LOCATION;let T;L&&t.config({uri:L});let C=[];const P=[],O=E&&b?(0,a.createLogFile)(E,"wsl-daemon"):(0,a.nullLogFile)();async function k(e){for(let t=0;t<C.length;t++)C[t]===e&&C.splice(t,1);0===C.length&&(O.log("No more customers => exit"),T?(O.log("Result available, waiting 3 sec before exiting"),setTimeout((()=>{0===C.length?N():O.log("Exit cancelled, new customer")}),3e3)):N())}async function N(){O.log("Exiting daemon");try{const e=new Promise(((e,t)=>R.close((r=>r?t(r):e()))));await Promise.allSettled([...P.map((e=>e())),e]),O.log("Exiting daemon complete")}catch(e){O.log(`Exiting daemon problem: ${e}`)}finally{try{await O.close()}catch(e){}process.exit(0)}}process.on("uncaughtException",(e=>{O.log(`Unhandled exception: ${e}`)})),process.on("unhandledRejection",(e=>{O.log(`Unhandled rejection: ${e}`)})),function(){let e=n.createMessageConnection(new n.StreamMessageReader(process.stdin),new n.StreamMessageWriter(process.stdout));e.listen(),e.onRequest(((e,...t)=>{throw new Error("Received unexpected request")})),C.push(e);const t=setInterval((function(){try{process.kill(h,0)}catch(r){clearInterval(t),k(e)}}),1e3)}();const R=s.createServer((e=>{const t=n.createMessageConnection(new n.SocketMessageReader(e),new n.SocketMessageWriter(e));if(t.listen(),C.push(t),void 0!==T)try{t.sendNotification(i.LogNotification,[`Connecting to daemon started by other WSL window... ${T.wslVersion}`,l.LogLevel.info]),t.sendNotification(i.PortResolvedNotification,T)}catch(e){F.write(`Error sending resolved info to other WSL window: ${e}`)}e.once("close",(()=>{k(t)}))}));function $(e){e&&"EADDRINUSE"===e.code||(console.error(e),process.exit(0));const t=e=>{console.error(e),F.write(e,l.LogLevel.error)},r=s.createConnection(f,(()=>{r.removeListener("error",t);const e=n.createMessageConnection(new n.SocketMessageReader(r),new n.SocketMessageWriter(r));e.listen();const o=C[0];e.onNotification(o.sendNotification),e.onRequest(o.sendRequest),e.onUnhandledProgress((e=>o.sendProgress(new n.ProgressType,e.token,e.value))),o.onNotification(e.sendNotification),o.onRequest(e.sendRequest),o.onUnhandledProgress((t=>e.sendProgress(new n.ProgressType,t.token,t.value))),r.once("close",(()=>{process.exit(0)}))}));r.once("error",t)}function M(e,t){C.forEach((r=>{r.sendNotification(e,t)}))}R.once("error",$),R.listen(f,(async()=>{R.removeListener("error",$),async function(){const e=await(0,d.getNodeExecServer)(),t={logger:F,sendDownloadRequest:W,setDefaultDistro:q,sendProgress:e=>M(i.ProgressNotification,e),onExit:P,wslExtensionLocation:p,appRoot:g,enableTelemetry:m,fileWatcherPolling:v,wslVersion:w,distro:S,enableDebug:b,useScriptlessStartup:y,defaultDistro:_,telemetryLevel:x,productConfiguration:(0,u.getProductConfiguration)(g)},r=await(0,c.setupRemoteServer)(t,e);"success"===r.kind?(T=r,M(i.PortResolvedNotification,r)):(M(i.FatalErrorOccuredNotification,r),N())}()}));let D=0;function W(e,t,r){const o=C[0],s=D++,n=o.onProgress(i.DownloadProgress,s,r);return o.sendRequest(i.DownloadRequest,{commit:e,platform:t,progressToken:s}).finally((()=>{n.dispose()}))}function q(e,t){return C[0].sendRequest(i.MakeDefaultRequest,{distro:e,current:t})}const F={write:(e,t=l.LogLevel.info)=>{O.log(e),M(i.LogNotification,[e,t])}};E&&F.write("WSL daemon log file: "+O.location)})();var s=exports;for(var n in o)s[n]=o[n];o.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();
//# sourceMappingURL=wslDaemon.js.map